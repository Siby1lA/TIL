# 모던자바스크립트

https://ko.javascript.info/

## 자바스크립트란?

웹페이지에 생동감을 불어넣기 위해 만들어진 프로그래밍 언어이다.
자바스크립트로 작성한 프로그램을 `script`라고 부른다.
script는 특별한 준비나 컴파일 없이 보통의 문자 형태로 작성하고 실행도 가능하다.

처음 자바스크립트가 만들어졌을 때는 `LiveScript`라는 이름이였다. 당시 자바가 인기가 높아 자바의 동생 격인 언어로 홍보해 자바스크립트로 이름을 바꿨다.
이름은 자바를 차용했지만 ECMAScript라는 고유한 명세를 갖춘 독립적인 언어이다.

- 자바스크립트는 브라우저뿐만 아니라 서버에서도 실행 가능하다.
- JavaScript engine이라 불리는 특별한 프로그램이 들어 있는 모든 디바이스에서도 동작한다.
- 브라우저엔 `자바스크립트 가상 머신`이라 불리는 엔진이 내장되어 있다.

엔진의 종류는 다양한데, 엔진마다 특유의 코드네임이 있다.

- V8 : Chorme, Opera에서 사용
- SpiderMonkey : Firefox에서 사용
- IE 버전에 따라 Trident, Chakra를 사용
  ChakraCore는 MS Edge, SquirrelFish는 Safari 에서 사용

위의 코드네임들은 종종 언급되기에 기억해 두는 것이 좋다.

## 엔진은 어떻게 동작하나?

깊게 들어가면 상당한 시간을 쏟아야 하지만 기본원리는 다음과 같다.

- 엔진(브라우저면 내장 엔진)이 스크립트를 읽는다(파싱)
- 읽어 들인 스크립트를 기계어로 전환한다 (컴파일)
- 기계어로 전환된 코드가 실행된다. 기계어로 전환되었기에 실행 속도가 빠르다.

엔진은 프로세스 각 단계마다 최적화를 진행한다. 심지어 컴파일이 끝나고 실행 중인 코드를 감시하면서, 이 코드로 흘러가는 데이터를 분석하고 분석 결과를 토대로 기계어로 전환된 코드를 다시 최적화하기도 한다. 이런 과정으로 스크립트 실행 속도는 더욱 더 빨라진다.

## 브라우저에서 할 수 있는 일

모던 자바스크립트는 안전한 프로그래밍 언어이다. 메모리나 CPU 같은 저수준 영역의 조작을 허용하지 않는다. 애초에 이러한 접근이 필요치 않은 브라우저 대상으로 만든 언어이기 때문이다.

브라우저 환경에선 웹페이지 조작, 클라이언트와 서버의 상호작용에 관한 모든 일이 가능하다.

### 브라우저에서 자바스크립트로 할 수 있는 일은

- 페이지에 새로운 HTML 추가, 기존 HTML 혹은 스타일 수정
- 마우스 클릭, 포인터의 움직임, 키보드 눌림 등과 같은 사용자 행동에 반응
- 네트워크를 통해 원격 서버에 요청을 보내거나, 파일 다운, 업로드(AJAX, COMET과 같은 기술 사용)
- 쿠키를 가져오거나 설정하기, 사용자에게 질문을 건네거나 메시지 보여주기
- 클라이언트 측에 데이터 저장하기(로컬스토리지)

### 브라우저에서 할 수 없는 일

브라우저는 보안을 위해 자바스크립트 기능에 제약을 걸어 놓았다.
이런 제약은 악성 웹페이지가 개인정보에 접근하거나 사용자 데이터를 손상하는 것을 막기 위함이다.

- 웹페이지 내 스크립트는 디스크에 저장된 임의의 파일을 읽거나 쓰고, 복사하거나 실행할 때 제약을 받을 수 있다. 이유는 운영체제가 지원하는 기능을 브라우저가 직접 쓰지 못하게 막혀있기 때문이다.

모던 브라우저를 사용하면 파일을 다룰 순 있는데 접근은 제한되어 있다.
사용자가 브라우저 창에 파일을 끌어다 두거나 `<input>` 태그를 통해 파일을 선택할 때와 같이 특정 상황에서만 파일 접근을 허용한다.

카메라나 마이크 같은 디바이스와 상호작용하려면 사용자의 명시적인 허가가 있어야 한다. 자바스크립트가 활성화된 페이지라도 사용자 몰래 웹 카메라를 작동시켜 수집한 정보를 몰래 전송할 수 없다.

- 브라우저 내 탭과 창은 대게 서로의 정보를 알 수 없다. 근데 자바스크립트를 사용해 한 창에서 다른 창을 열ㄷ 때는 예외다. 하지만 이 경우에도 도메인이나 프로토콜, 포트가 다르다면 페이지에 접근할 수 없다.

이런 제약사항을 '동일 출처 정책(Same Origin Polich)'라 부른다. 이 정책을 피하려면 두 페이지는 데이터 교환에 동의하고 동의와 관련된 특수한 자바스크립트 코드를 포함해야 한다.

다시 한번 강조하자면 이런 제약 사항은 사용자의 보안을 위해 만들어졌다.
홈페이지1 에서 받아온 페이지가 홈페이지2에서 받아온 페이지 상의 정보에 접근에 개인정보를 훔치는 걸 막기 위함이다.

- 자바스크립트를 이용하면 페이지를 생성한 서버와 쉽게 정보를 주고 받을 수 있다. 하지만 타 사이트나 도메인에서 데이터를 받아오는 건 불가능하다. 가능하다 해도 원격 서버에서 명확히 승인을 해줘야 한다. 이 역시 보안을 위해 만들어진 제약이다.

브라우저 환경 밖, 예를 들어 서버라면 이러한 제약은 존재하지 않을 것이다 다만, 모던 브라우저에선 추가 권한 허가를 요청하는 플러그인이나 익스텐션 설치가 허용된다.

## 자바스크립트만의 강점

간단히 세 가지만 언급하자면

- HTML/CSS와 완전히 통합 가능
- 간단한 일은 간단하게 처리할 수 있게 해줌
- 모든 주요 브라우저에서 지원하고, 기본 언어로 사용됨

이 세 가지 모두를 지원하는 브라우저 연관 기술은 자바스크립트뿐이다.
이러한 특징 때문에 브라우저 인터페이스를 만들 때 가장 널리 사용된다.
이 외에도 서버나 모바일 앱 등을 만드는 것도 가능하다.

## 자바스크립트 '너머의' 언어들

자바스크립트의 문법은 모든 사람의 요구를 충족시키진 못한다. 사람마다 각기 다른 기능을 원하기 때문이다.

프로젝트마다 요구사항이 천차만별이기 때문에 어찌보면 당연하다.

이로 인해 근래엔 브라우저에서 실행되기 전에 자바스크립트로 트랜스파일(transpile, 변환) 할 수 있는 새로운 언어들이 많이 등장했다.

최신 툴을 사용하면 트랜스파일을 빠르고 명확하게 수행할 수 있다. 최신도구는 자바스크립트 이ㅚ에 언어로 작성한 코드를 '보이지 않는 곳에서' 자바스크립트로 자동 변환해준다.

자바스크립트로 트랜스파일이 가능한 몇가지 언어

- CoffeScripnt : JS를 위한 'syntactic sugar' 짧은 문법을 도입해 명료하고 이해하기 쉬운 코드를 작성할 수 있다. Ruby 개발자들이 좋아한다.
- TypeScript : 개발을 단순화 하고 복잡한 시스템을 지원하려는 목적으로 '자료형의 명시화(strict data typeing)'에 집중해 만든 언어이다. Microsoft가 개발했다.
- Flow : 역시 자료형을 강제하는데 TypeScript와는 다른 방식을 사용한다. Fecebook이 개발했다.
- Dart : 모바일 앱과 같이 브라우저가 아닌 환경에서 동작하는 고유의 엔진을 가진 독자적 언어이다. Google이 개발했다.

이 외에다 트랜스파일 할 수 있는 언어는 다양하다. 개발 언어로 이런 언어 중 하나를 택한다고 하더라도 자신이 무엇을 하고 있는지 이해하려면 결국엔 자바스크립트를 알아야 한다.

## 요약

- 자바스크립트는 브라우저에서만 쓸 목적으로 고안된 언어이지만, 지금은 다양한 환경에서 쓰이고 있다.
- 오늘날 자바스크립트는 브라우저 환경에서 가장 널리 사용되는 언어로 자리매김하였다. HTML/CSS와 완전한 통합이 가능하다.
- 자바스크립트로 '트랜스파일'할 수 있는 언어는 많다. 각 언어마다 고유한 기능을 제공한다. 자바스크립트를 숙달한 뒤에 이 언어들을 살펴볼 것을 추천한다.
